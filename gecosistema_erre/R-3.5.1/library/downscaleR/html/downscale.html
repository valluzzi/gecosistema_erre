<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Perfect-prog downscaling</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for downscale {downscaleR}"><tr><td>downscale {downscaleR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Perfect-prog downscaling</h2>

<h3>Description</h3>

<p>Workhorse function to call the different perfect-prog downscaling methods
</p>


<h3>Usage</h3>

<pre>
downscale(y, x, newdata = x, method = c("analogs", "glm", "lm"),
  simulate = c("no", "yes"), n.analogs = 1, sel.fun = c("mean", "wmean",
  "max", "min", "median"), wet.threshold = 0.1, n.pcs = NULL,
  cross.val = c("none", "loocv", "kfold"), folds = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>y</code></td>
<td>
<p>The observations dataset. It should be an object as returned by <span class="pkg">loadeR</span>.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>The input grid. It should be an object as returned by <span class="pkg">loadeR</span>.</p>
</td></tr>
<tr valign="top"><td><code>newdata</code></td>
<td>
<p>It should be an object as returned by <span class="pkg">loadeR</span> and consistent with x. Default is newdata = x.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>Downscaling method. Options are c = (&quot;analogs&quot;,&quot;glm&quot;,&quot;lm&quot;). Glm can only be set when downscaling precipitation.</p>
</td></tr>
<tr valign="top"><td><code>simulate</code></td>
<td>
<p>Character. Options are <code>"no"</code>, <code>"yes"</code>.</p>
</td></tr>
<tr valign="top"><td><code>n.analogs</code></td>
<td>
<p>Applies only when <code>method="analogs"</code> (otherwise ignored). Integer indicating the number of closest neigbours to retain for analog construction. Default to 1.</p>
</td></tr>
<tr valign="top"><td><code>sel.fun</code></td>
<td>
<p>Applies only when <code>method="analogs"</code> (otherwise ignored). Criterion for the construction of analogs when several neigbours are chosen. Ignored when <code>n = 1</code>.
Current values are <code>"mean"</code> (the default), <code>"wmean"</code>,  <code>"max"</code>,  <code>"min"</code> and  <code>"median"</code>.</p>
</td></tr>
<tr valign="top"><td><code>wet.threshold</code></td>
<td>
<p>Value below which precipitation amount is considered zero</p>
</td></tr>
<tr valign="top"><td><code>n.pcs</code></td>
<td>
<p>Integer indicating the number of EOFs to be used as predictors</p>
</td></tr>
<tr valign="top"><td><code>cross.val</code></td>
<td>
<p>Should cross-validation be performed? methods available are leave-one-out (<code>"loocv"</code>)
and k-fold (<code>"kfold"</code>). Default to <code>"none"</code>, which does not perform cross-validation.</p>
</td></tr>
<tr valign="top"><td><code>folds</code></td>
<td>
<p>This arguments controls the number of folds, or how these folds are created (ignored if <code>cross.val = "loocv"</code>). Folds are always splitted chronologically. If it is given as a fraction in the range (0-1), 
it splits the data in two subsets, one for training and one for testing, being the given value the fraction of the data used for training (i.e., 0.75 will split the data so that 75% of the instances are used for training, and the remaining 25% for testing). 
In case it is an integer value, it sets the number of folds in which the data will be split (e.g., <code>folds = 10</code> for the classical 10-fold cross validation). 
Alternatively, this argument can be passed as a list, each element of the list being a vector of years to be included in each fold (See examples).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Scaling and centering</strong>
When the climate variables are used as predictors instead of the PCs, these are previously centered and scaled
using the mean and sigma parameters globally computed for the whole spatial domain.
</p>


<h3>Value</h3>

<p>The prediction structure.
</p>


<h3>See Also</h3>

<p>downscale.train for training a downscaling model
downscale.predict for prediction for a a test dataset with a trained model for 
downscale.cv for automatic cross-validation 
<a href="https://github.com/SantanderMetGroup/downscaleR/wiki/training-downscaling-models">downscaleR Wiki</a> for downscaling seasonal forecasting and climate projections.
</p>
<p>Other downscaling.functions: <code><a href="downscale.cv.html">downscale.cv</a></code>,
<code><a href="downscale.predict.html">downscale.predict</a></code>,
<code><a href="downscale.train.html">downscale.train</a></code>
</p>


<h3>Examples</h3>

<pre>
x &lt;- makeMultiGrid(NCEP_Iberia_hus850, NCEP_Iberia_ta850)
newdata &lt;- subsetGrid(x, years = 1994:1995)
x &lt;- subsetGrid(x, years = 1985:1993)
# Loading predictands
y &lt;- VALUE_Iberia_pr
y &lt;- getTemporalIntersection(obs = y,prd = x, "obs" )
x &lt;- getTemporalIntersection(obs = y,prd = x, "prd" )
### Analogs ###
# None
yp &lt;- downscale(y,x,method = "analogs")
yp &lt;- downscale(y,x,newdata,method = "analogs")
# kfold
yp &lt;- downscale(y,x,method = "analogs", n.pcs = 15,
                cross.val = "kfold", folds = list(c(1985,1986,1987),
                                                  c(1988,1989,1990),
                                                  c(1991,1992,1993)))
# Leave-one-year-out
yp &lt;- downscale(y,x,method = "analogs", n.pcs = 15,
                cross.val = "loocv")

### GLM ###
# None
yp &lt;- downscale(y,x,method = "glm", simulate = "no",  n.pcs = 10,
                wet.threshold = 1)
yp &lt;- downscale(y,x,method = "glm", simulate = "yes", n.pcs = 10,
                wet.threshold = 1)
# kfold
yp &lt;- downscale(y,x,method = "glm", simulate = "no", n.pcs = 10,
                cross.val = "kfold", folds = list(c(1985,1986,1987),
                                                  c(1988,1989,1990),
                                                  c(1991,1992,1993)))
</pre>

<hr /><div style="text-align: center;">[Package <em>downscaleR</em> version 3.0.1 <a href="00Index.html">Index</a>]</div>
</body></html>
