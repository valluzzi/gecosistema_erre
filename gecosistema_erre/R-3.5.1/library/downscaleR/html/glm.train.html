<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Donwscaling with generalized linear models (GLM).</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for glm.train {downscaleR}"><tr><td>glm.train {downscaleR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Donwscaling with generalized linear models (GLM).</h2>

<h3>Description</h3>

<p>Donwscaling with generalized linear models (GLM) with the base function <code><a href="../../stats/html/glm.html">glm</a></code>.
</p>


<h3>Usage</h3>

<pre>
glm.train(x, y, fitting = NULL, simulate = "no", ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>The grid data. Class: matrix.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>The observations data. Class: matrix.</p>
</td></tr>
<tr valign="top"><td><code>fitting</code></td>
<td>
<p>A string indicating the types of objective functions and how to fit the linear model.</p>
</td></tr>
<tr valign="top"><td><code>simulate</code></td>
<td>
<p>A string indicating wether we want a stochastic or a deterministic GLM. Stochastic GLMs only accept gamma 
or binomial families.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Optional parameters. See the parameter fitting for more information.
</p>

<ul>
<li> <p><code>fitting = NULL</code> In this case the generalized linear model uses the <code><a href="../../stats/html/glm.html">glm</a></code> function to fit the linear model. 
This is the default option.
The optional parameters when fitting = NULL are:
</p>

<ul>
<li> <p><code>family</code> A string indicating a description of the error distribution. Options are 
family = c(&quot;gaussian&quot;,&quot;binomial&quot;,&quot;Gamma&quot;,&quot;inverse.gaussian&quot;,&quot;poisson&quot;,&quot;quasi&quot;,&quot;quasibinomial&quot;,&quot;quasipoisson&quot;). 
The links can be also specified and can be found in <code><a href="../../stats/html/family.html">family</a></code>.
</p>
</li>
<li> <p><code>na.action</code> A function which indicates what should happen when the data contain NAs. 
The default is set by the na.action setting of options, and is na.fail if that is unset. 
The ‘factory-fresh’ default is na.omit. Another possible value is NULL, no action. Value na.exclude can be useful.
</p>
</li></ul>

</li>
<li> <p><code>fitting = "stepwise"</code> Indicates a stepwise regression via <code><a href="../../stats/html/glm.html">glm</a></code> and <code><a href="../../stats/html/step.html">step</a></code>.
The optional parameters are the same than for fitting = NULL. The stepwise performs always a forward selection search stopping
based on the AIC criterion.
</p>
</li>
<li> <p><code>fitting = c("L1","L2","L1L2","gLASSO")</code>. These four options refer to ridge regression (L1 penalty), lasso regression (L2 penalty),
elastic-net regression (L1L2 penalty) and group Lasso regression (group L2 penalty). The model is fitted via 
<code><a href="../../glmnet/html/glmnet.html">glmnet</a></code> and the corresponding penalties are found via <code><a href="../../glmnet/html/cv.glmnet.html">cv.glmnet</a></code>. This function <code><a href="../../glmnet/html/glmnet.html">glmnet</a></code>
forces by default to standardize predictors, however we have changed it to standardize = FALSE, and standardization should be done prior to 
the downscaling process. 
The optional parameters when fitting = c(&quot;L1&quot;,&quot;L2&quot;,&quot;L1L2&quot;,&quot;gLASSO&quot;) are:
</p>

<ul>
<li> <p><code>family</code> A string indicating a description of the error distribution. Options are 
family = c(&quot;gaussian&quot;,&quot;binomial&quot;,&quot;Gamma&quot;,&quot;inverse.gaussian&quot;,&quot;poisson&quot;,&quot;quasi&quot;,&quot;quasibinomial&quot;,&quot;quasipoisson&quot;). 
The links CAN NOT be specified as the <code><a href="../../glmnet/html/glmnet.html">glmnet</a></code> has not been programmed to handle links.
However, the default ones can be found in <code><a href="../../stats/html/family.html">family</a></code>. If fitting = &quot;gLASSO&quot; then family must be &quot;mgaussian&quot;.
</p>
</li>
<li> <p><code>offset</code> A vector of length nobs that is included in the linear predictor (a nobs x nc matrix for the &quot;multinomial&quot; family). 
Useful for the &quot;poisson&quot; family (e.g. log of exposure time), or for refining a model by starting at a current fit. 
Default is NULL. If supplied, then values must also be supplied to the predict function.
</p>
</li></ul>

</li></ul>

<p>There are two things to consider. 
1) If family = &quot;binomial&quot; then type = &quot;response&quot; when predicting values.
2) Except for fitting = &quot;MP&quot;, for the rest of the fitting options, the parameter singlesite must be TRUE, unless 
we want a gLASSO which in this case singlesite must be FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is internal and should not be used by the user. The user should use <code><a href="downscale.train.html">downscale.train</a></code> or <code><a href="downscale.cv.html">downscale.cv</a></code>.
</p>


<h3>Value</h3>

<p>The GLM model as returned from <code><a href="../../stats/html/glm.html">glm</a></code> plus a list with information concerning the experiment.
</p>


<h3>Author(s)</h3>

<p>J. Bano-Medina
</p>

<hr /><div style="text-align: center;">[Package <em>downscaleR</em> version 3.0.1 <a href="00Index.html">Index</a>]</div>
</body></html>
