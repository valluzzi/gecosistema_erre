<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Bias correction ISI-MIP method</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for isimip {downscaleR}"><tr><td>isimip {downscaleR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Bias correction ISI-MIP method</h2>

<h3>Description</h3>

<p>Implementation of the ISI-MIP methodology
</p>


<h3>Usage</h3>

<pre>
isimip(y, x, newdata, threshold = 1, type = c("additive", "multiplicative"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>y</code></td>
<td>
<p>A grid or station data containing the observed climate data for the training period</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>A grid containing the simulated climate by the model for the training period. This can be either
the same variable as <code>obs</code>, in the case of model calibration (bias correction and related techniques) or MOS (model
output statistics) approaches, or a set of predictors in the case of <em>perfect prog</em> downscaling approaches (possibly
after principal component analysis via the <code><a href="../../transformeR/html/prinComp.html">prinComp</a></code> output).</p>
</td></tr>
<tr valign="top"><td><code>newdata</code></td>
<td>
<p>A grid containing the simulated climate for the variables used in <code>x</code>, but considering the test period.</p>
</td></tr>
<tr valign="top"><td><code>threshold</code></td>
<td>
<p>The minimum value that is considered as a non-occurrence (e.g. precipitation). Default to 1.</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>Type of bias correction approach, either multiplicative (e.g. precipitation, <code>type = "multiplicative"</code>)
or additive (e.g. temperature, <code>type = "additive"</code>, the default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methods available are qqmap, delta, unbiasing, scaling and Piani (only precipitation).
</p>
<p><strong>ISI-MIP</strong>
</p>
<p>Recently, Hempel et al.2013 proposed a new bias correction methodology within the ISI-MIP Project, 
the first Inter-Sectoral Impact Model Intercomparison Project, funded by the German Federal Ministry 
of Education and Research (BMBF). This method has been developed to preserve the change signal (trend, 
climate change signal, etc.) and can be applied to several variables (precipitation, mean, maximum and 
minimum temperature, windspeed and eastward/northward components, radiation, pressure and humidity). 
The main difference with the rest of bias correction methods included in the <code><a href="biasCorrection.html">biasCorrection</a></code> 
function is that the ISI-MIP method includes dependencies between some variables. That is, to correct some 
of the variables (maximum/minimum temperatures and eastward/northward wind components) others are needed 
(mean temperature and windspeed).
</p>
<p>sim &lt;- isimip(obs, pred, sim) # Temperature or other variable
</p>
<p>sim &lt;- isimip(obs, pred, sim, pr.threshold = threshold) # In the case of precipitation we should include the threshold considered of wet/dry days
</p>


<h3>Value</h3>

<p>A calibrated object of the same spatio-temporal extent of the input grid
</p>


<h3>Author(s)</h3>

<p>S. Herrera
</p>


<h3>References</h3>


<ul>
<li><p> Hempel, S., Frieler, K., Warszawski, L., Schewe, J., and Piontek, F. (2013) A trend-preserving bias correction: the ISI-MIP approach, Earth Syst. Dynam., 4, 219-236
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="biasCorrection.html">biasCorrection</a></code> for details on other standard methods for bias correction
</p>
<p>Other downscaling: <code><a href="biasCorrection.html">biasCorrection</a></code>,
<code><a href="glimpr.html">glimpr</a></code>
</p>


<h3>Examples</h3>

<pre>
## Not run: 
# Download VALUE (station data) and NCEP (model data) datasets 
dir.create("mydirectory")
download.file("http://meteo.unican.es/work/downscaler/data/VALUE_ECA_86_v2.tar.gz", 
              destfile = "mydirectory/VALUE_ECA_86_v2.tar.gz")
download.file("http://meteo.unican.es/work/downscaler/data/Iberia_NCEP.tar.gz", 
              destfile = "mydirectory/Iberia_NCEP.tar.gz")
# Extract files from the tar.gz file
untar("mydirectory/VALUE_ECA_86_v2.tar.gz", exdir = "mydirectory")
untar("mydirectory/NCEP_Iberia.tar.gz", exdir = "mydirectory")
# Path to the VALUE dataset and the NCEP ncml file.
value &lt;- "mydirectory/VALUE_ECA_86_v2"
ncep &lt;- "mydirectory/Iberia_NCEP/Iberia_NCEP.ncml"
# Data inventories provides a quick overview of the available data
value.inv &lt;- dataInventory(value)
ncep.inv &lt;- dataInventory(ncep)
str(value.inv)
str(ncep.inv)
# Load precipitation for boreal winter (DJF) in the train (1991-2000) and test (2001-2010) periods,
# for the observations (VALUE) and the Iberia_NCEP datasets
obs &lt;- loadStationData(dataset = value, var="precip", lonLim = c(-12,10), latLim = c(33,47),
                       season=c(12,1,2), years = 1991:2000)
prd &lt;- loadGridData(ncep, var = "tp", lonLim = c(-12,10), latLim = c(33,47),
                    season = c(12,1,2), years = 1991:2000)
sim &lt;- loadGridData(ncep, var = "tp", lonLim = c(-12,10), latLim = c(33,47),
                    season = c(12,1,2), years = 2001:2010)
# Interpolate the observations onto the model's grid. We use the method "nearest" 
# and the getGrid function to ensure spatial consistency:
obs &lt;- interpGrid(obs, new.coordinates = getGrid(prd), method = "nearest")
# Apply the bias correction method:
simBC &lt;- isimip (obs, prd, sim, threshold = 1) # ISI-MIP Method
par(mfrow = c(1,2))
plotMeanGrid(sim)
plotMeanGrid(simBC)
par(mfrow = c(1,1))

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>downscaleR</em> version 3.0.1 <a href="00Index.html">Index</a>]</div>
</body></html>
