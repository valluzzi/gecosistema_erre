<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Reconstruct a Grid from EOFs and principal components</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for gridFromPCA {transformeR}"><tr><td>gridFromPCA {transformeR}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Reconstruct a Grid from EOFs and principal components</h2>

<h3>Description</h3>

<p>Reconstructs a grid of a climatic variable from the outputs of a
principal components analysis
</p>


<h3>Usage</h3>

<pre>
gridFromPCA(prinCompObj, var)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>prinCompObj</code></td>
<td>
<p>A EOF analysis object as returned by <code><a href="prinComp.html">prinComp</a></code></p>
</td></tr>
<tr valign="top"><td><code>var</code></td>
<td>
<p>Character string indicating the variable to be re-constructed. In case of
PCA analyses performed on a single variable (either multimember or not), this can be omitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A grid
</p>


<h3>Author(s)</h3>

<p>J. Bedia
</p>


<h3>See Also</h3>

<p>Other pca: <code><a href="PC2grid.html">PC2grid</a></code>, <code><a href="grid2PCs.html">grid2PCs</a></code>,
<code><a href="plotEOF.html">plotEOF</a></code>, <code><a href="prinComp.html">prinComp</a></code>
</p>


<h3>Examples</h3>

<pre>
# Multigrid constructor:
multigrid &lt;- makeMultiGrid(NCEP_Iberia_hus850, NCEP_Iberia_ta850, NCEP_Iberia_psl)
# In this example, we retain the first 10 PCs
pca &lt;- prinComp(multigrid, n.eofs = 10)
# We recover the sea-level pressure grid from the its PCs:
names(pca)
psl2 &lt;- gridFromPCA(pca, "psl")
str(psl2)
# The attributes of psl2 indicate that this is a reconstructed grid from 10 PCs, 
# explaining 99\% of the variance:
attributes(psl2)
multigrid$Variable$varName
# psl is the 3rd one

# An example of multimember reconstruction from a multimember PC analysis:
data("NCEP_Iberia_psl")
plotClimatology(climatology(NCEP_Iberia_psl), backdrop.theme = "coastline",
                main = "DJF Mean Sea-level Pressure (1983-2002)")
pca2 &lt;- prinComp(NCEP_Iberia_psl, n.eofs = 1)
psl_recovered &lt;- gridFromPCA(pca2)
plotClimatology(climatology(psl_recovered), backdrop.theme = "coastline", 
                main = "DJF Mean Sea-level Pressure (1983-2002)\n-Reconstructed from first EOF-")
# The mean field is similar, but there are (small) differences in temporal variability:
plot(NCEP_Iberia_psl$Data[,3,3], ty = 'l', ylab = "psl")
lines(psl_recovered$Data[,3,3], col = "red")
title("Time series for a selected grid-point")
legend("top", c("original", "reconstructed"), lty = 1, col = c(1,2), bty = "n")
# The 1st EOF captures 85% of total MSLP field variance:
attributes(psl_recovered)$'explained_variance'
</pre>

<hr /><div style="text-align: center;">[Package <em>transformeR</em> version 1.4.2 <a href="00Index.html">Index</a>]</div>
</body></html>
